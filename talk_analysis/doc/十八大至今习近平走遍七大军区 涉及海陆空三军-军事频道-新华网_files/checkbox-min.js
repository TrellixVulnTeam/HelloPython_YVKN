KISSY.add("xh/common/1.0/checkbox",function(c,b){var e=function(){this.opts={selector:"",className:{container:"checkbox",checked:"checkbox-checked"}};this.cbList=[];this.inputList=[]};e.fn=e.fn||{};e.fn.extend=function(h,i){if(typeof h!=="object"||typeof i!=="object"){return h}for(var g in i){if(typeof h[g]!=="undefined"&&typeof i[g]===typeof h[g]){if(typeof h[g]==="object"&&!(h[g] instanceof Array)){e.fn.extend(h[g],i[g])}else{h[g]=i[g]}}else{h[g]=i[g]}}return h};var d=e.fn;var f=c.DOM;var a=c.Event;c.augment(e,{init:function(k){d.extend(this.opts,k);var l=this.opts;this.cbList=f.query(l.selector);var h=this.cbList.length;var g=null;for(var j=h-1;j>=0;j--){g=this.cbList[j];if(!g.type||g.type.toLowerCase()!=="checkbox"){this.cbList.splice(j,1)}}this.install()},install:function(){var m=this;f.hide(this.cbList);var h=this.opts.className;var g=null;var l=function(i){var n=parseInt(i.getAttribute("data-check-index"));var o=i.getAttribute("data-checked");if(isNaN(n)){return}if(o){f.removeClass(i,h.checked)}else{f.addClass(i,h.checked)}o=o?"":"checked";m.cbList[n].checked=o;i.setAttribute("data-checked",o)};for(var k=0;k<this.cbList.length;k++){g=this.cbList[k];var j=document.createElement("input");j.type="button";j.value="";j.className=h.container;j.setAttribute("data-check-index",k);j.setAttribute("data-checked",g.checked?"checked":"");f.insertBefore(j,g);this.inputList.push(j);a.add(j,"click",function(){l(this)});if(g.checked){j.className+=" "+h.checked}}},getState:function(h){h=parseInt(h);if(isNaN(h)){throw new Error("there is no index for checkbox")}var g=this.cbList[h];return g.checked?true:false},getValue:function(h){h=parseInt(h);if(isNaN(h)){throw new Error("there is no index for checkbox")}var g=this.cbList[h];return g.value},getChecked:function(){var j=[];for(var h=0;h<this.cbList.length;h++){var g=this.cbList[h];if(g.checked){j.push(g.value)}}return j},getCanceled:function(){var j=[];for(var h=0;h<this.cbList.length;h++){var g=this.cbList[h];if(!g.checked){j.push(g.value)}}return j},trigger:function(g){if(g<0||g>this.inputList.length-1){return}a.fire(this.inputList[g],"click")},triggerAll:function(){a.fire(this.inputList,"click")},check:function(g){if(g<0||g>this.inputList.length-1){return}var h=this.inputList[g];var j=h.getAttribute("data-checked");if(!j){a.fire(h,"click")}},cancel:function(g){if(g<0||g>this.inputList.length-1){return}var h=this.inputList[g];var j=h.getAttribute("data-checked");if(j){a.fire(h,"click")}},checkAll:function(){for(var g=0;g<this.inputList.length;g++){this.check(g)}},cancelAll:function(){for(var g=0;g<this.inputList.length;g++){this.cancel(g)}}});return e},{requires:["node"]});
